on the temporal analysis of fairness by f bar university l university the university abstract the use of the temporal logic formal for program reasoning is aspects of and fair ness analyzed to the need for an additional temporal operator the un operator u some general questions involving the until operator are then discussed it is shown that with the tion of this operator the temporal lan guage becomes complete then two deductive systems dx and are proved to be complete for the languages without and with the new operator respectively introduction the formalism of temporal logic has been suggested as a appropriate tool for reasoning about programs and ex originally temporal logic has been designed in order to analyze and son about time sequences in general formal the possible variations in time of a situation we consider time sequences where each si is a state giving a full description of the at instant l o temporal logic introduces a clear distinction within a state which is described using classic connective and quantifiers and the over time moving from one state to another for changes over time special temporal to work or are or t copies to non to prior is by permission of machinery to copy otherwise or to republish requires a fee and or specific permission i acm are introduced the temporal opera that we will consider in this paper are given below with their interpretation for an arbitrary time sequence the truth value of a classical non temporal formula w at instant i is found by evaluating w on si f is the existential future operator fw is true at an instant some future instant i if j ji there that w is true at the instant j g is the universal future operator gw is true at an instant i if for all future j ji w holds at j x is the next instant operator is true at i if w is true at il u is the until operator is true at i if there exists a future in j ji such that w is at j and for all k in between ie w is true at k thus w uw means that the next occurrence will be true of w by our until tion implies to write the above truth definition formally we consider a language with atomic classical connective av the and the connective we let mu is a linearly be a model ordered set and where m each atom q of the the the notion ii w fol language qi is con of q we define mem by induction on the formula w wl is the truth val ue of w at m in the model m m is usually omitted and we write for w u q atomic u true iff false iff u true iff false or u u in case m has an successor mem and true true iff st if mm such that true and for all ml u g m is called an when its m consists of set time u of the natural numbers with their usual order ing a formula w is said to be when u true for all m and all we denote by lu the obtained from by xf this involves since no loss of expressive fw a true false u w u w power gw is defined to be the formula fw the application of temporal logic to program reasoning is based on the view of programs as generators of execution if we allow nondeterministic prog then each input to a program a set of possible execution sequences each execution sequence is a sequence o of program states such that o is the initial state containing the input and each il is derived from s by executing the appropriate program inst by including the program location as part of the state the appropriate inst or set of possible instructions in the nondeterministic case is uniquely id obviously by stating proper which hold for all the execution of a program we are stating proper of the generating program to illustrate this point let the pro gram be labeled by labels go being the entry point and e the exit point let us select a set of propositions at o e such that is true in a program state s iff when in state s the program is about to execute the in at location i the following temporal formula expresses then the prop of partial correctness with respect to an inputoutput specification w j interpreting this formula in state so of an execution sequence so if program at o variables we are at equal s it reads o with the to an input satisfying then it is true that whenever we reach the tion point will hold between the in put values and the current value of the program variables note that this correctness provided the program term but does not guarantee termination itself similarly to express total correct ness we write j this guarantees that if we satisfy the proper initial conditions then we will ev get to a state at which both and are true hence to correct tion this general idea of expressing and proving properties of programs by temporal reasoning on the set of their execution sequences was several works pi in greater detail in p kl it has been shown there that the language consisting of the operators x and f and hence also g is a powerful tool for formalizing many important properties of programs its main strength and lie in the treatment of properties which cannot be expressed when pro grams as functions or relations properties are of essential the se in dis operating systems concurrent grams and nonterminating in general cyclic properties programs ing to the form of the temporal formula and hence expressing the applicable the we arrive proof method at the following simplest classes invariance properties expressible by a formula of the form the class of invariance contains the properties of safety partial correctness mutual sion clean performance deadlock freedom properties expressible by a formula of the form it includes among others the properties of liveness total correctness freedom etc the language was also shown to be for the detailed description of the execution of a concurrent program model this enables the definition of the semantics of a concurrent system and a derivation of proof principles for proving its properties p however more properties in particular these ing fairness led us to the realization that the language is not expressive ly complete by this we mean that there ex some important properties which cannot be expressed in such a limited system the simplest one is that of the until tion itself p u q which states that q is bound to happen and until it happens p will hold as a result the language that we present here is an augmented lan guage lu u which is based on the operators and g the question naturally arises whether we will not even some further properties which could not be expressed even in this extended system we provide a negative ans to this question by showing that the lu language is complete we also provide an axiomatic system which is shown to be complete for lu we will the operator emphasize the importance by listing first of some properties involving which can be expressed without the u and then some properties which must use the until operator for their expression we will list first different of according to the strength of their commit ment a response to the weakest form of states that a holding of a tion or a request p will eventually force a response q this can be written as gp z fq or if stated all future behaviors fq sometimes the response q the from being frozen at the request ing state in this case once q becomes true p to hold the hypothesis gp this difficulty is only and we can write instead the logically equivalent condition gp a q namely it is impossible for p to be frozen and q never to realize to illustrate the of such a statement consider a component process which is waiting for of a a tion say xo which some other process is expected to generate m if x u o the n to m we use the proposition atm which is true at each time instant in which the execution of our process is at m namely about to ex m then the only statement we can make about this situation and its tion is m ie it is impossible for the process to be stuck at m while x is tive it implies that the scheduler will eventually schedule this process which will find x positive and proceed beyond m this is also the weakest definition of a behavior as well as the fairness requirement from any scheduler it requires that any process will eventual ly be scheduled for execution note that for this allows infinite over taking b response to a stronger requirement and the one which most a behavior is that the infinitely occurrence of the condition p will eventually cause q we do not require p to hold but only to be true infinitely often the statement of this is a fq or if required z fq similarly to the case above the first form is logically which we will equivalent sometimes to prefer consider a semaphore instruction m px the proper statement of its behavior is this states that no process can be waiting at m for a semaphore entry while the variable turns true positive infinitely often note that to ensure this it is not sufficient to guarantee that this process will be infinitely often because by some high ly run of bad all these scheduling with instances could exactly the instances in which and the process will never proceed the same criterion should apply to the fairness of conditional critical section tions m with p when b do s here we should also require w ie it is impossible to remain stuck for ever at m while states in which both b hold and the resource r is free repeat infinitely often this can be implemented by means of and a queue or us ing an unbounded counter it cannot be done with alone see and for a discussion a weaker interpretation of the tional critical section is also possible this one guarantees only b is held true from a certain if point on while r becomes free positive infinitely often the implementation of this weaker construct by is easy c response to an the strongest type of is the one in which a single occurrence of p guarantees q this is written as p fq more generally gp fq it is a natural and useful expression for the discussion of total correctness sometimes and other temporal of internal events it is too strong on the other hand for the expression of responses to al signals and conditions this is so be cause it is the case that a system is so that it could always detect a single occurrence of an incoming signal which does not repeat having formulated the different types of we can augment them with requirements for fairness while quite well in cases a c with just the fg operators we must introduce now the until operator u consider the following situations d absence of responses we may wish to complement the state ment that p will eventually cause q p a fq by saying that on the other hand q will never happen unless by a p we may wish to state for example that a resource allocation system will not grant a resource who did not request it ignoring boundary effects ie p and q simultaneously this can be expressed as ie that if q is going to happen at all it cannot happen until p first or concurrently e strict fairness suppose there are two requests pi and p and two corresponding responses ql and q we may wish to impose strong fifo discipline state that on the agent and if pl p then ql will q for this it is convenient to express the fact that starting from the present the first occurrence of p must be pre by an occurrence of p in fact this is exactly the expression used in d above and we define generally u fp p u pi the strict can now be written as discipline fifo consider for example two instructions m px m n px l a fifo implementation of require would one could use this as a basic axiom for the behavior of under a given fifo implementation and then deduce from it a global fifo behavior of larger parts of the program an example of statements and reasoning about strict fairness exists in ll d and e really only a first approximation to the properties we had in mind for example strictly ensures only that the first occurrence of q is by an occurrence of p what exact ly we would like to have is every q is by a p which after the last q if any thus we cannot be with a single p by many qs even though this situation formally satisfies the requirement every q is by a p the property described above ie interleaving of at least one p between consecutive qs can be described as it states that as a reference point either the initial state or any instant in which q holds ensures that the first instance of q after the reference point is by an instance of p occurring between the reference point and the in of q in view of the demonstrated importance of the operator u we will now address ourselves to the more theoretical questions of its contribution of the language to the expressive and the appropriate power tive system for reasoning about lu we pose the following questions is stronger than or could u in terms of fx we perhaps express is complete or are there some other reason able properties which cannot be expressed even in lu what is an appropriate de system for what is an appropriate deductive system for question no was by kp ch iv theorem who showed that u cannot be expressed in terms of an even richer language than was ac the first to deal with these tions that is expressive ly incomplete and to introduce the until operator part the as well as its past counter since operator he also showed that the language with both the and until f operators is complete for expressing situations extend ing over the past present and future the main new point in our work as compared to his is in addition to a simpler proof the isolation of the future fragment and showing its independent completeness since a dual proof applies to the past fragment this provides an alternate derivation of original result and a separation property of the mixed language in to lu and ls also our methods have led to a solution of a problem left open by that of obtaining a natural temporal language which is complete for arbitrary linearly ordered time structures see end of section solution to question the is presented in sec tion deductive systems for both and have been suggested in p and my respectively and for these system dx for have been complete in these works but proofs were not presented in section we pro an outline of a proof which applies to both systems and establishes their complete ness lu is complete we begin by defining our notion of expressive comparison completeness will be the the standard of firstorder l of linear order l is a firstorder language with equality containing the bin predicate and unary predicates y which we identify with the atomic of the propositional tem that language lu described l and lu are interpreted before note in the same kind of models namely in structures m z where is a lin ordering of m and qi m for iu the model m is said to be complete when every nonempty bounded subset of m has a least upper bound and a greatest lower bound in the ordering discrete when every ele ment mem which is not maximal in m has an immediate successor and every element has an immediate predecessor an when m is the set of al numbers with its usual ordering every as well as a model ordered like the integers is both discrete and complete the ordered set of real numbers is complete but not discrete and the ordered set of rational numbers is incomplete there is a natural translation of into such that for every model m m and mem e is satisfied in m by the ele ment m i ff e is true in m at the instant m we express this by saying that t e in m at mem expressive m for all models m and all completeness means the of a translation in the other dir and is given for in the following theorem theorem for every formula x of ll there is an lu formula such that w in every at the point o the restriction because the truth to point o is necessary value of any in m at m depends only on what happens in m at and after m not before m whereas may refer also to the past this theorem is a special case of the following one in which the x u o is removed but we assume that qx has a special form by a formula l we mean a formula all to of restricted to x ie are of the form or yx such form refer only to the f the moment x present and future theorem for every future formula qx of l we can find an el such that v u in every discrete complete model at every point this is closely related to the main result of which asserts that the lan guage with since and until is ex complete with respect to the full language ll over complete models our approach to theorem can easily be adapted to give a simpler proof of theorem which in fact follows and its dual for the case from theorem of discrete complete follows ordering conversely from theorem theorem together with the following theorem every formula is equivalent to a boolean formulas over discrete combination complete of models and lu in a sense is equivalent to the conjunction of and s result in g theorem is proved by a direct argument theorem and and shown to hence theorem imply the proof of presented here follows ss proof of outline first we need a normal form for with any num of free variables in order to restrict later to formulas xy which refer only to what happens between x and y allowing y or x this includes also formulas about the future of x or the past of y for every variable z let be the set of all formulas of the form qz ie or m if x are distinct variables define the set of formulas by induction on n as follows u and for each i i e let u u u u call a formula xl xk special on xl xk when it has the form am where tive order of xl mu and each vi is n determines the rela xk say xl xk in the set u lemma xl is equivalent to a finite disjunction xk of special formulas on xl x k this is proved by induction on v and is essentially kl ch ii theorem i the next task is to analyze the expressive er of a formula in where x or y may also be or it is at this point that our proof begins to diverge from s we define the notion of a formula this is a formula xy of the form zo z n ia n il where each of an lu q is a translation into l formula if y we allow tional conjuncts of the form each main lemma is j every an l translation formula in too is equivalent to a disjunction of tion formulas applying this lemma to a form yields theorem since a decomposition of x is easily into an lu formula about x the lemma itself is proved by induction on n for formulas in the part involves negation and is over come by prop a negation of a decomposition formula is equivalent to a finite tion of decomposition formulas in order to prove this proposition we introduce the concept of event express ions these are terms of an auxiliary lan guage which describe first or last occur of events given by a temporal form a typical event expression may be the last q occurrence before the first p occurrence in the interval xy a main lemma is the proof states that for each decomposition formula we can find a finite set of event expressions such that their relative order determines the truth value of the decomposition formula conversely every statement of the rela tive order of some event expressions is equivalent to a disjunction of tion formulas since a finite set of event expressions has a finite number of possible order and any interval in a given model exactly one of these the negation of some of them is equivalent to the disjunction of the rest this leads to proposition this proof can be modified to apply to an arbitrary complete linear order not isomorphic to natural numbers we can then obtain an alternate proof of result about expressive completeness of u and s moreover we can add to u s two more u and s handling and the following theorem theorem every formula can be translated into a formula e of such that model at z o in any point every linearly ordered dx and are complete in this section we present two axiom systems dx for and for and prove their deductive com ie every temporal formula of the language which is valid in all is provable in the appropriate system validity in this section should be taken as validity in all the axiomatic u models system can be taken as follows axioms fine take fw u gw as primitive and de al a a a a u u rules of inference r r r if w is a then kw lf and w then fw if lw then generalization the system consisting of aa rr is the system dx while the full system adding ul u is the system the interpretation is the one given in the introduction theorem soundness if ­ w then w is valid if then w is valid for w in the two appropriate guages and lan theorem completeness if w is valid then proof if k is valid then let wo be a consistent wff will construct a finitely representable we satisfying wo the proof proceeds through several major steps we construct first a model s w whose elements a are each a maximal consistent theory a maximal set of formulas which are consistent relative to i op ii s is not necessarily an u mod el but it satisfies wo next we take a finite set of formulas r which contains wo and all of its sub formulas and is closed under some requirements so eg if then al we construct a finite model obtained by identifying states points of s which agree over r up to this point the pro is very similar to the proof of com for propositional dynamic logic see also fl the problem with is that a state may have more then one successor we thread through an infinite path which has the property that it traverses infinitely often every node of one of the strongly connected components of in other words if a node ne appears infinitely often in the path then so does each of its successors this ultimately periodic path serves as our final model a more detailed description follows let s be the set of all maximal consistent theories of the system a argument shows that for some ao in s define the and on s a u following relations a iff for all w it can be shown that using the axioms and for every and if then for some and we thus restricted to the set of all a is a linear order consistent with f the next step is to extend wo to a set r of formulas having the following closure properties a b r is closed under and boolean operations moreover r can be chosen so as to con only finitely many distinct formulas up to logical equivalence let clearly s is a finite set definition define iff for pp on by some and s u iff for some ao and t s lemma p is the transitive closure of p the proof uses the induction axiom scheme a we are ready now to define the model let so u which is an element of containing wo let sn be a sequence of states from such that for any te if t si for infinitely many i then every t such that is also equal to infinitely many si we use sn to form our final model the truth assignment for the atoms in this model is given by qi u lemma for any u the proof proceeds by induction on w for each connective we use the axioms involving that connective we thus get that we have shown that u true for any o u true there exist in the model qi such that this proves the completeness theorem corollary both dx and are able since the final model constructed was finitely representable we can deduce from the proof a bound depending on wo for the size of its finite representation hence if a formula is satisfiable it is satisfiable by a model whose complexity does not this bound and a decision procedure exists comment in the earlier work pp my the temporal operators were defined in a somewhat different way than in this work the definitions here more closely to the conventions used by temporal log denoting the temporal operators under the interpretation given in pi etc by respectively they can be re to the operators used here as fol note we include future or that the difference is whether the present as a part of the it also u has an character while uo has a character in discussing program prop natural the operators seem more as the reader of section might have realized the axiom systems dx and described above can easily be transformed to systems and for and respectively complete au a a a go ul u the inference rules are the same using o in g the generalization rr constitute while the full system is a system equivalent to appears in references fl fischer mj and rl modal logic of pro grams proc of the th acm symp on the theory of computing col may d axiomatization of programs manuscript of lc g kl k ll l mp my p ss d the separation property of logics manuscript sept d a proof of correctness of semaphore implementation of the statement tech report tr cornell university ny logic and the theory of linear order phd thesis university of california completeness results in temporal logic l a temporal analysis of fairness thesis university of pennsylvania lamport l proving the correctness of programs ieee trans software engineering se march l pp lamport l the ness of programs acm toplas vol no pp manna z pnueli a the modal logic of programs int conference in automata languages and program ming july myers tj and a pnueli the tem situation until now cal note university of ia pnueli a the temporal logic of programs th annual symp on foundations of computer science pnueli a ri the temporal semantics of concurrent programs int symp semantics of concurrent computation july s completeness j expressive for temporal logic 