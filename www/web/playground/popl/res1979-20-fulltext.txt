university string pattern matching in polynomial extended abstract time k c of a c the university of introduction there is a wide range of applications for string processing and snobol et al has come to be the most widely implemented and accepted language for such applications no one of the principle reasons for this is the data structure around which the lan guage is organized the string pattern this structure together with the associated pattern matching process provide great flexibility it has been widely recognized in informal terms that the pattern matching process is often inefficient and that the pattern struc ture is difficult to explain and use each of these areas of difficulty relates to such things as two modes of operation scan prob with heuristics in the scan etc some difficulties are inherent with string patterns but many are not we feel the developments described here help to this situation in section we describe the formal model upon which we base this work this allows the careful analysis of the variety of sets of strings which may be specified by the patterns which we admit and deduction to be made concerning the possibility of algorithms of interest with snobol it has been the case that the careful of the meaning of a pattern is in terms of the actions taken by the pattern matching rithm this has led to the of of a particular algorithm into the understanding of the pattern structure this seems to using a compiler as the definition of a language and we believe it is to future progress to have other alternatives in section we point out that the execution time of the usual snobol pattern ing algorithm is exponential in the length of the subject string even on some quite simple patterns we then present an algorithm whose worstcase time is polynomial and that operates on patterns which include a true set complement operator as side benefits we find that the algorithm is not modal and correctly handles the null string as an the work of both authors in the project by the national science foundation grant was alternative and in order to space we will assume throughout this paper that the reader is familiar with the idea of a string pattern in the sense that it is described in et al also it is probably necessary that the reader some general knowledge of the formal languages area the formal model as we in the introduction we feel that it is crucial that the concept of a string pattern be given a meaning completely independent of whatever matching algorithms might be recently and have discussed formal models for certain classes of string patterns their models were directed at the pattern matching process particularly as it is by the combination of patterns under operations these models do not seem well suited to extension to the operations we consider here or generally to the concerns we follow the analogy between or contextfree and snobol patterns has sometimes been made and is informally but systematically treated in t we use the formal grammars approach and for the operations of interest we have the details of the definition of an rewriting system informally patterns the following in snobol terms we will which can be defined by means of operations assignment written alternation written as written and i concatenation written immediate value assignment written i as operands we admit string constants and simple ables ie identifiers we that the variables used for immediate value assignment be disjoint from those used with ordinary assignment and that they have some specified initial string value the informal interpretation of n is that a string matches p if and only if it does not match pattern p some must be taken when the corn operator is allowed so that logically consistent definitions cannot be made for the p mp in snobol the expression operator would be required on the right side any string which does not match p to match p and vice versa inconsistent systems may be less obvious of course for example the system we where the chain of resulting any system of pattern definitions complement operator occurs along the a recursive definition and show that systems are always welldefined the it should also considering a static are considered a be noted that since we are model of string patterns pat in isolation not as part of system all occurrences of an identifier on the righthand side of an met are regarded sense as in the a canonical pattern definition system provides for a collection of assignments to identifiers the expressions on the righthand side of the assignments each consist of one or more alternatives the alternation operation con is essentially that of snobol see et al t with the exception of being commutative each alternative consists of a con of factors where a factor is either a string constant an identifier a identifier or a factor with the immediate value operator applied the immediate value operator is understood in the sense of snobol we assume that the identifiers used with the value operation are disjoint from those which occur in the collection of assignments we also assume a given initial string value for all immediate value variables which we take here to always be the null string with each canonical pattern definition system we associate a characteristic where the nodes of the consist of the identifiers occurring in the assignments of the system and there is an edge from to if in the assignment a occurs in expression without and there is an edge lab v complement if occurs in with our algorithm and results then le systems which characteristic contains no cycle which uses an edge lab it may be proven that each such system does give a description of a tion of strings if p is a canonical pattern definition the set of strings described by p consists of all strings which match p in their in snobol terms pattern matching would succeed for and is written lp a derivation relation using the productions can be defined to exactly result in lp space limitations do not allow for the tion of the formal definitions but we suggest the nature of the rewriting rules with the examples below the details of the formal definitions appear in example a pattern p describing o p xx note that the parentheses are used only to emphasize also this exactly to snobol if expres sion is added to p and x now as explicit rewriting rules we would have pa and pp xx rules which contain neither immediate value assign ment nor i maybe re as ordinary contextfree rewriting rules to deal with immediate value assignment each step of a derivation is regarded as having an additional component for each immediate value variable which contains its current value actually each component must carry a stack of values the rewriting rules which involve must then manipulate these com also when an immediate value variable is to be rewritten ie it occurs other than as the of it is the value of the corresponding component of the step for instance for this example we have p p ax xx xs s the rewriting pa of the replaces clause px by the the entire clause by a and in addition establishes this as the value of x then in the clause ax x the leftmost x is rewritten as a so the entire clause is re placed by aa and in addition this value is established as the value of x example a pattern i na u describing q ab s bc t u it s bc s tr to avoid circularity in the definition of the derivation relation for one must exercise care we depend in a crucial way on the earlier mentioned restriction that does not occur along a chain of recursive tions this means that there is only a finite depth of possible in a tion and that when is used it can only be in conjunction with a more shallow able hence the derivation relation can be de by induction on the depth in the derivation where the for depth zero is essentially the case augmented by facilities in example for instance in this exam ple we note a p for b r c iff for c hence t c iff w q or s l d hence u c iff w and s l and the claim for the example is established the power of the definition systems under consideration to the usual formal languages the following results class of pattern can be hierarchy by theorem the collection of sets of strings de by canonical pattern definition systems properly includes the languages and is closed under union complement intersection and iteration star but is not closed under homomorphism proof omitted hence the family of languages described by canonical pattern definition systems includes the hierarchy of languages de by and also it can be verified that if a system does not contain value ie the only extension is tion and the terminal alphabet has just one symbol then the language described is regular this observation in conjunction with example shows the independence of the immediate value operation from theorem there is arbitrary canonical will determine if no algorithm which pattern definition given an system p a lp o b lp is finite or infinite proof omitted of occur as t all equality course since the a special case of pattern the other usual decision are also grammars definition sys problems eg the algorithm widely our first observation recognized matching algorithm is to quantify the of the snobol pat assertion the requires time proportional contextfree patterns the length of the subject matching to n where string algorithm for n is the assertion can be verified by evaluating performance of the algorithm see t or on a pattern definition such as because of space limitations and particularly the precise grammar definitions omitted in the last section we can only informally describe the operation of our polynomial time pattern ing algorithm for canonical pattern definition t the algorithm is derived from parsing algorithm in fact in the case of patterns ie those canonical pattern systems not or the algorithm essentially reduces to and hence operates in time benefit we obtain an algorithm which has no difficulty with or null string alternatives the following the reader of algorithm discussion is familiar of the algorithm with the details the polynomial time pattern matching ­ algorithm ­ the states of are augmented so that for each immediate value variable x in the there are additional components ix and s the components x are integers whose range is bounded and ix by the length of the subject string and sx is a stack of integers whose maximum depth is the maximum depth of nesting of assignments to x and whose elements are bounded in size by the length of the string the sets of states ie si are manipulated as in algorithm with the following additions a when immediate assignment to x is to take place the value of x is a string of the subject string and is re right as l and r the left x x and indices of this substring with values reference to the initial value b while an immediate value variable x is being processed the characters of its value are compared to the subject string and the index the processing i tracks x the progress through this value of c as positions of nested assignment to x are encountered they are in sx at the time of assignment the top value and is used for l x in addition complement the maintains states the complement sets states of have all of the components mentioned above for ordinary states plus a component to record the starting index in the subject string of a substring that can be derived from a variable and a flag that records tion of the variable the algorithm also sets of ment states ni in the following manner a when the a variable it adds a complement state flag to n added with i and the appropriate b after each of the states in si have been processed the complement states in ni are processed by a for ment basically if a variable did not complete then its complement did and another state may be added to si some other technical changes are required in the processors described by that are not discussed here the first result we mention for the algorithm the importance of the formal model theorem correctness definition system with subject string if for any canonical p the applied s gives success if pattern to p and only proof omitted given a formal we turn our attention justification of correctness to performance theorem given a canonical pattern definition sys tem p there is a constant kp so that for any subject string of length n the operating time of is bounded by where m is the number of immediate assignment variables d is the maximum depth of nesting of immediate assignment to a variable and proof o if occurs otherwise omitted in p several special cases are of note in the above result if neither complement nor immediate value assignment is used then cm o and performance is if only complement is used the perform is however for immediate value assignment both the number of variables and the depth of assignment nesting play roles and a very large value for either performance though of course it is always poly that the reader may feel due to the of so many details we would like to close by pointing out that in addition to having fully developed the definitions and proofs to here the authors have produced and extensively tested an implementation of the algo rithm outlined here a report of some of the experience with this implementation and other details is given in references ap macro a snobol compiler vol and j ing an efficient comm contextfree vol no b ac formal models for string in current in programming vol data r prenticehall and their vol a theory implementation no of discrete in snobol patterns comm re the macro snobol wh co implementation of re the snobol prenticehall ip language nd cd kc pattern science an efficient matching dept university algorithm thesis of for string computer ly and p of intersections guages math sys an infinite of contextfree lan theory gd ment of no re snobol programs the measure sigplan notices vol gf patterns gramming an algebraic model acm nd symp on principles languages palo alto for string of pro numeric implementing software applications prenticehall for non 